
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0041)http://h5case.xiaoxxx.com/201710/aliCalc/ -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <title>阿里巴巴集团股权税金计算器</title>
    <style type="text/css">
        *, html, body {
            padding: 0;
            margin: 0;
            font-family: '微软雅黑'
        }

        a, img {
            border: 0 none;
            text-decoration: none;
        }

        ul, ol, li {
            list-style: none;
        }

        *:focus {
            outline: none;
        }

        .clearfloat:after {
            display: block;
            clear: both;
            content: "";
            visibility: hidden;
            height: 0
        }

        .clearfloat {
            zoom: 1
        }

        html, body, #main {
            width: 100%;
            height: 100%;
        }

        .container {
            margin: 0 auto;
            position: relative;
            width: 990px;
            height: 100%;
        }

        #title {
            width: 100%;
            height: 124px;
            color: #fff;
            text-align: center;
            color: #fff;
        }

        #title .container {
            border-bottom: 1px solid #1abfc9;
            background: #14c8d3;
        }

        #headline {
            font-size: 20px;
            font-weight: bold;
            padding: 12px 0 5px 0;
        }

        #subtitle {
            font-size: 18px;
        }

        #submit {
            background: #f36b6b no-repeat;
            border-radius: 8px;
            width: 110px;
            height: 34px;
            border: 0 none;
            float: left;
            margin-left: 225px;
            cursor: pointer;
            text-align: center;
            line-height: 34px;
            border: 1px solid #f36b6b;
            font-size: 18px;
        }

        #reset {
            border-radius: 8px;
            width: 110px;
            height: 34px;
            float: left;
            margin-left: 15px;
            cursor: pointer;
            text-align: center;
            line-height: 34px;
            border: 1px solid #fff;
            font-size: 20px;
        }

        #formDiv {
            color: #fff;
            height: 520px;
        }

        #formDiv .container {
            padding-top: 40px;
            background: url(http://gtms04.alicdn.com/tps/i4/TB16LcwGVXXXXacXVXXMo1AIpXX-963-63.jpg) bottom repeat-x #17cfda;
            height: 100%;
            box-sizing: border-box;
        }

        #sum {
            width: 555px;;
            float: left;
        }

        #sum li {
            float: left;
            width: 69px;
            height: 20px;
            font-size: 14px;
            text-align: center;
            line-height: 20px;
            cursor: pointer;
            margin: 0 12px 8px 0;
            border: 1px solid #fff;
            border-radius: 4px;
            position: relative;
        }

        #sum li.checked {
            background-color: #ff7e00;
            border-radius: 4px;
            border: 1px solid #ff7e00;
        }

        .form-div {
            padding-left: 77px;
            width: 478px;
            margin-bottom: 11px;
        }

        .form-div label {
            float: left;
            width: 225px;
            font-size: 15px;
        }

        .form-div input {
            width: 225px;
            height: 26px;
            line-height: 26px;
            border: 1px solid #baf1f4;
            padding: 0 5px;
            text-align: right;
            background: #17cfda;
            color: #fff;
        }

        input:disabled {
            background: #ccc;
            color: #aaa;
        }

        .form-div input:-moz-placeholder {
            color: #ddd;
        }

        .form-div input:-ms-input-placeholder {
            color: #ddd;
        }

        .form-div input::-webkit-input-placeholder {
            color: #ddd
        }

        #batchUL {
            width: 249px;
            height: 60px;
            float: left;
        }

        #rateTable {
            margin-left: 20px;
            float: left;
            background: #15bcc6;
            border-top: 1px solid #74e2e9;
            border-left: 1px solid #74e2e9;
            width: 338px;
        }

        #rateTable th, #rateTable td {
            border-bottom: 1px solid #74e2e9;
            border-right: 1px solid #74e2e9;
        }

        #rateTable th {
            font-size: 17px;
            height: 30px;
            line-height: 22px;
            text-align: center;
        }

        #rateTable td {
            font-size: 12px;
            height: 38px;
            line-height: 38px;
            padding-left: 7px;
        }

        #rateTable td.tdRight {
            text-align: right;
            padding: 0 10px 0 0;
        }

        #rateTable td.tdCenter {
            text-align: center;
            padding: 0;
        }

        #rateTable tr.active {
            color: #fcff00;
        }
        
        #rateTable tbody tr:first-of-type td {
            line-height: 20px;
        }

        #result {
        }

        #result .container {
            padding: 0 57px;
            width: 876px;
        }

        #resultTitle {
            background: url(http://gtms03.alicdn.com/tps/i3/TB1R3AFGVXXXXb6XpXXW17vGpXX-37-13.png) center 26px no-repeat;
            height: 35px;
            text-align: center;
            font-size: 24px;
            color: #f77474;
            border-bottom: 1px solid #e8e8e8;
            line-height: 31px;
            padding-top: 52px;
            width: 990px;
            margin-left: -57px;
        }

        #resultTitle span {
            display: inline-block;
            *display: inline;
            *zoom: 1;
            height: 34px;
            border-bottom: 2px solid #f77474;
            margin-bottom: 1px;
        }

        .resultTable {
            float: left;
            background: #fff;
            width: 398px;
        }

        .resultTable td {
            padding: 0 8px;
            height: 34px;
            line-height: 34px;
        }

        .resultTable tfoot td {
            font-size: 12px;
        }

        .resultTable1 {
            border-top: 1px solid #f8d1d1;
            border-left: 1px solid #f8d1d1;
        }

        .resultTable1 td {
            border-bottom: 1px solid #f8d1d1;
            border-right: 1px solid #f8d1d1;
            color: #e45f5f;
            font-size: 14px;
        }

        .resultTable1 td.pink {
            background: #f9eaea;
        }

        .resultTable1 td.red {
            background: #f9a3a3;
            color: #fff;
        }

        .resultTable2 {
            border-top: 1px solid #bee9cc;
            border-left: 1px solid #bee9cc;
        }

        .resultTable2 td {
            border-bottom: 1px solid #bee9cc;
            border-right: 1px solid #bee9cc;
            color: #65b17d;
            font-size: 14px;
        }

        .resultTable2 td.pink {
            background: #eef8f1;
        }

        .resultTable2 td.red {
            background: #8fd0a4;
            color: #fff;
        }

        .resultTable3 {
            border-top: 1px solid #b5d9dc;
            border-left: 1px solid #b5d9dc;
        }

        .resultTable3 td {
            border-bottom: 1px solid #b5d9dc;
            border-right: 1px solid #b5d9dc;
            color: #289097;
            font-size: 14px;
        }

        .resultTable3 td.pink {
            background: #d0fcff;
        }

        .resultTable3 td.red {
            background: #51c8cf;
            color: #fff;
        }

        .table {
            float: left;
            margin: 40px 20px 0 20px;
        }

        #total {
            font-size: 15px;
            color: #f77474;
            font-weight: bold;
            margin-top: 40px;
            padding-left: 20px;
            line-height: 30px;
        }

        #total div {
            float: left;
            width: 50%;
        }

        #tip {
            font-size: 14px;
            color: #5e5e5e;
            padding: 15px 0 40px 20px;
        }

        #mask {
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            right: 0;
            background: #000;
            filter: alpha(opacity=50);
            -moz-opacity: 0.5;
            opacity: 0.5;
            display: none;
        }

        #alert, #alert2 {
            position: fixed;
            left: 50%;
            top: 50%;
            width: 350px;
            height: 120px;
            margin: -75px 0 0 -175px;
            background: #fff;
            text-align: center;
            font-size: 16px;
            color: #333;
            border-radius: 8px;
            padding-top: 30px;
            display: none;
        }
        
        #msg > p {
            font-size: 14px;
            margin-top: 5px;
        }

        .confirm {
            padding: 3px 0;
            height: 36px;
            margin-top: 10px;
            text-align: center;
            background: #f36b6b no-repeat;
            border-radius: 8px;
            width: 110px;
            border: 1px solid #f36b6b;
            color: #fff;
            cursor: pointer;
        }

        .confirm.closeBtn {
            background: #ddd;
            border-color: #ccc;
            margin-left: 20px;
        }

        #container {
            width: 990px;
            border-left: 2px solid #17cfda;
            border-right: 2px solid #17cfda;
            margin: 0 auto;
            min-height: 100%;
            background: #fafafa;
        }

        #formTip {
            position: absolute;
            left: 77px;
            top: 70px;
            width: 200px;
            font-size: 12px;
        }
        
        #formTip > .en {
            width: 485px;
            margin-top: 8px;
        }

        .eColor {
            color: #fff;
        }

        .en > span {
            float: left;
            width: 50%;
            font-size: 12px;
            letter-spacing: -1px;
            white-space: nowrap;
        }

        .en > span:last-of-type {
            text-align: right;
            float: right;
            padding-right: 20px;
            box-sizing: border-box;
        }

        #submit > .eColor,#reset > .eColor {
            font-size: 14px;
        }
        
        #batchUL > li {
            margin-bottom: 22px;
        }

        .tableEn {
            font-size: 12px;
        }

        .resultTable .multiple {
            line-height: 22px;
        }

        #resultTitle i {
            font-style: normal;
            font-size: 18px;
        }
    </style>
</head>
<body>
<div id="main">
    <div id="container">
        <div id="title">
            <div class="container">
                <div id="headline">阿里巴巴集团股权税金计算器 <p class="eColor">Alibaba Group Holding Share Award Income Tax Calculator</p></div>
                <div id="subtitle">（上市公司适用）<p class="eColor">( Only subject to Post-IPO Award)</p></div>
            </div>
        </div>
        <div id="formDiv">
            <div class="container clearfloat">
                <form id="sum">
                    <div class="form-div clearfloat">
                        <label for="batch">同一自然年度归属批次</label>
                        <input type="hidden" name="batch" id="batch" value="1">
                        <ul id="batchUL">
                            <li value="1" onclick="radioCheck(&#39;batch&#39;,this);" class="checked">第一批<p class="eColor">Batch 1</p></li>
                            <li value="2" onclick="radioCheck(&#39;batch&#39;,this);">第二批<p class="eColor">Batch 2</p></li>
                            <li value="3" onclick="radioCheck(&#39;batch&#39;,this);">第三批<p class="eColor">Batch 3</p></li>
                            <li value="4" onclick="radioCheck(&#39;batch&#39;,this);">第四批<p class="eColor">Batch 4</p></li>
                            <li value="5" onclick="radioCheck(&#39;batch&#39;,this);">第五批<p class="eColor">Batch 5</p></li>
                            <li value="6" onclick="radioCheck(&#39;batch&#39;,this);">第六批<p class="eColor">Batch 6</p></li>
                        </ul>
                    </div>
                    <div class="form-div clearfloat" style="margin: 82px 0 5px 0;">
                        <label for="types">股权类型 <span class="eColor">Award Type</span></label>
                        <input type="hidden" name="types" id="types" value="1">
                        <ul id="typesUL">
                            <li value="1" onclick="radioCheck(&#39;types&#39;,this);" class="checked">RSU</li>
                            <li value="2" onclick="radioCheck(&#39;types&#39;,this);">OPTION</li>
                        </ul>
                    </div>
                    <div class="form-div clearfloat">
                        <label id="countLabel">归属数量 <span class="eColor">Vesting Units</span></label>
                        <input id="count" type="text" placeholder="请输入整数的数量" value="" onblur="placeHolder(&#39;count&#39;);isInteger(&#39;count&#39;);" onfocus="inputFocus(&#39;count&#39;);">
                        <div class="en"><span class="eColor">Key in your vesting units</span></div>
                    </div>
                    <div class="form-div clearfloat" id="priceDiv">
                        <label>行权价（US$）- OPTION适用</label>
                        <input id="price" type="text" placeholder="请输入最多两位小数的行权价格" value="" disabled="disabled" onblur="placeHolder(&#39;price&#39;);isMoney(&#39;price&#39;);" onfocus="inputFocus(&#39;price&#39;);">
                        <div class="en">
                            <span class="eColor">Option Strike Price (US$)</span>
                            <span class="eColor">Key in your option price ( in 2 decimals )</span>
                        </div>
                    </div>
                    <div class="form-div clearfloat">
                        <label id="sharesLabel">归属前一天收盘股价（US$）</label>
                        <input id="shares" type="text" placeholder="请输入最多两位小数的收盘价格" value="" onblur="placeHolder(&#39;shares&#39;);isMoney(&#39;shares&#39;);" onfocus="inputFocus(&#39;shares&#39;);">
                        <div class="en" id="toggle">
                            <span class="eColor">The Closing Share Price Prior to Vesting Date</span>
                            <span class="eColor">Key in your estimated price ( in 2 decimals )</span>
                        </div>       
                    </div>
                    <div class="form-div clearfloat">
                        <label>汇率（US$:RMB）</label>
                        <input id="exchangeRate" type="text" placeholder="请输入美元：人民币汇率，如：6.1" value="" onblur="placeHolder(&#39;exchangeRate&#39;);isRate(&#39;exchangeRate&#39;);" onfocus="inputFocus(&#39;exchangeRate&#39;);">
                        <div class="en">
                            <span class="eColor">Foreign Exchange Rate (RMB/USD)</span>
                            <span class="eColor">Key in the FX Rate</span>
                        </div>       
                    </div>
                    <div class="form-div clearfloat" style="padding-top:5px;">
                        <div id="submit" value="" onclick="submitForm();">
                            计算<p class="eColor">CALCULATE</p>
                        </div>
                        <div id="reset" value="" onclick="resetForm();">
                            重置<p class="eColor">RESET</p>
                        </div>
                    </div>
                </form>
                <table id="rateTable" cellpadding="0" cellspacing="0">
                    <thead>
                    <tr>
                        <th colspan="4">个人所得税率表
                            <p class="eColor">Individual Income Tax Table</p>
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="tdCenter" width="46">级数<p class="eColor">Tiers</p></td>
                        <td class="tdCenter" width="150">应纳税所得额（含税级距）<p class="eColor">Taxable Income subject to gross up</p></td>
                        <td class="tdCenter" width="60">税率 <p class="eColor">Tax Rate</p></td>
                        <td class="tdCenter">速算扣除数 <p class="eColor">Quick Deduction</p></td>
                    </tr>
                    <tr>
                        <td class="tdCenter">A1</td>
                        <td>0-1,500</td>
                        <td class="tdCenter">3%</td>
                        <td class="tdRight">-</td>
                    </tr>
                    <tr>
                        <td class="tdCenter">A2</td>
                        <td>1,501-4,500</td>
                        <td class="tdCenter">10%</td>
                        <td class="tdRight">105</td>
                    </tr>
                    <tr>
                        <td class="tdCenter">A3</td>
                        <td>4,501-9,000</td>
                        <td class="tdCenter">20%</td>
                        <td class="tdRight">555</td>
                    </tr>
                    <tr>
                        <td class="tdCenter">A4</td>
                        <td>9,001-35,000</td>
                        <td class="tdCenter">25%</td>
                        <td class="tdRight">1005</td>
                    </tr>
                    <tr>
                        <td class="tdCenter">A5</td>
                        <td>35,001-55,000</td>
                        <td class="tdCenter">30%</td>
                        <td class="tdRight">2755</td>
                    </tr>
                    <tr>
                        <td class="tdCenter">A6</td>
                        <td>55,001-80,000</td>
                        <td class="tdCenter">35%</td>
                        <td class="tdRight">5505</td>
                    </tr>
                    <tr>
                        <td class="tdCenter">A7</td>
                        <td>Above 80,000</td>
                        <td class="tdCenter">45%</td>
                        <td class="tdRight">13505</td>
                    </tr>
                    </tbody>
                </table>
                <div id="formTip">
                    <p>（备注：同一自然年度内归属的多批股权收益需合并计税，请按批次点击依次填写）</p>
                    <p class="en">Award Income Details 
                (Notes: Award incomes realized during the same tax year need be accumulated for calculating. Please fill in your already-realized income records batch by batch in right section)</p>
                </div>
            </div>
        </div>
        <div id="result">
            <div class="container">
                <div id="resultTitle"><span>计算结果<i>(Calculation Result)</i></span></div>
                <div id="tableDiv" class="clearfloat"></div>
                <div id="total" class="clearfloat">
                    <div>本年度累计归属/行权收益（RMB）：<span id="totalIncome">0.00</span></div>
                    <div>总计应缴个人所得税（RMB）：<span id="totalTax">0.00</span></div>
                    <div>Accumulated Taxable Incomes (RMB): <span id="totalIncomeE">0.00</span></div>
                    <div>Accumulatd Tax Payable (RMB)：<span id="totalTaxE">0.00</span></div>
                </div>
                <div id="tip">
                    <p>* 该计算结果仅供参考，实际应缴个人所得税以公司计算结果为准。</p>
                    <p>* Above calculation is only for reference. Acutal tax amount is subject to company's result.</p>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="mask"></div>
<div id="alert">
    <div id="msg"></div>
    <input id="confirm" class="confirm" onclick="closeAlert();" value="确定(Confirm)" type="button">
</div>
<div id="alert2">
    <div id="msg">请重置后再重新计算 <p>Please resume your calculation after clicking “Reset”</p></div>
    <input id="reset2" class="confirm" onclick="closeAlert();resetForm();" value="重置(Reset)" type="button">
    <input id="close2" class="confirm closeBtn" onclick="closeAlert();" value="关闭(Close)" type="button">
</div>
<script type="text/javascript">
    var income = new Array();
    var tax = new Array();
    var taxType = ["RSU", "OPTION"];
    var tableType = ["resultTable1", "resultTable2", "resultTable3", "resultTable1", "resultTable2", "resultTable3"];
    var tempNum, res = new Array();
    resetForm();

    function radioCheck(str, obj) {
        var n = obj.getAttribute("value");
        document.getElementById(str).value = n;
        if (str == "types" && n == 1) {
            document.getElementById("price").setAttribute("disabled", "disabled");
            document.getElementById("countLabel").innerHTML = "归属数量 <span class='eColor'>Vesting Units</span>";
            document.getElementById("sharesLabel").innerHTML = "归属前一天收盘股价（US$）";
            document.getElementById("toggle").innerHTML = "<span class='eColor'>The Closing Share Price Prior to Vesting Date</span> <span class='eColor'>Key in your estimated price ( in 2 decimals )</span>";
            if (navigator.userAgent.indexOf("MSIE") > 0) {
                if (navigator.userAgent.indexOf("MSIE 8.0") > 0 || navigator.userAgent.indexOf("MSIE 7.0") > 0) {
                    document.getElementById("price").style.background = "#ccc";
                    document.getElementById("price").style.color = "#aaa";
                }
            }
        } else if (str == "types" && n == 2) {
            document.getElementById("price").removeAttribute("disabled");
            document.getElementById("countLabel").innerHTML = "行权数量 <span class='eColor'>Exercise Units</span>";
            document.getElementById("sharesLabel").innerHTML = "行权前一天收盘股价（US$）";
            document.getElementById("toggle").innerHTML = "<span class='eColor'>The Closing Share Price prior to Exercise Date (US$)</span> <span class='eColor'>Key in your estimated price ( in 2 decimals )</span>";
            if (navigator.userAgent.indexOf("MSIE") > 0) {
                if (navigator.userAgent.indexOf("MSIE 8.0") > 0 || navigator.userAgent.indexOf("MSIE 7.0") > 0) {
                    document.getElementById("price").style = "";
                    //placeHolder('price');
                }
            }
        } else if (str == "batch") {
            document.getElementById("count").value = "";
            document.getElementById("price").value = "";
            document.getElementById("shares").value = "";
            document.getElementById("exchangeRate").value = "";
            placeHolder('count');
            placeHolder('price');
            placeHolder('shares');
            placeHolder('exchangeRate');
            if (document.getElementById("types").value == 1) {
                if (navigator.userAgent.indexOf("MSIE") > 0) {
                    if (navigator.userAgent.indexOf("MSIE 8.0") > 0 || navigator.userAgent.indexOf("MSIE 7.0") > 0) {
                        document.getElementById("price").setAttribute("style", "background:#ccc;color:#aaa;");
                    }
                }
            }
            if (n < income.length) {
                document.getElementById("alert2").setAttribute("style", "display:block");
                document.getElementById("mask").setAttribute("style", "display:block");
            }
        }
        var temp = obj.parentNode.getElementsByTagName("li");
        for (var i = 0; i < temp.length; i++) {
            temp[i].removeAttribute("class");
        }
        obj.setAttribute("class", "checked");
    }

    function submitForm() {
        var n = tax.length;
        var batch = parseInt(document.getElementById("batch").value);
        if (batch - 1 > n) {
            document.getElementById("alert").setAttribute("style", "display:block");
            document.getElementById("mask").setAttribute("style", "display:block");
            document.getElementById("msg").innerHTML = "请先完成之前所有批次税金的计算！<p>Please ensure your previous Vesting/Exercise records are fully calculated</p>";
        } else {
            var temp1 = 0;
            temp2 = 0;
            for (var i = 0; i < (batch - 1); i++) {
                temp1 += income[i];
                temp2 += tax[i];
            }
            var type = parseInt(document.getElementById("types").value);
            var count = parseInt(document.getElementById("count").value);
            var shares = parseFloat(document.getElementById("shares").value);
            var exchangeRate = parseFloat(document.getElementById("exchangeRate").value);
            var price = 0, rate, reduction;
            if (type == 2) {
                price = document.getElementById("price").value;
            }
            var r1 = Math.round(count * (shares - price) * exchangeRate * 100) / 100 + temp1;
            var tr = document.getElementById("rateTable").getElementsByTagName("tr");
            for (var i = 0; i < tr.length; i++) {
                tr[i].removeAttribute("class");
            }
            if (r1 / 12 <= 1500) {
                rate = 0.03;
                reduction = 0;
                tr[2].setAttribute("class", "active");
            } else if (r1 / 12 > 1500 && r1 / 12 <= 4500) {
                rate = 0.10;
                reduction = 105;
                tr[3].setAttribute("class", "active");
            } else if (r1 / 12 > 4500 && r1 / 12 <= 9000) {
                rate = 0.20;
                reduction = 555;
                tr[4].setAttribute("class", "active");
            } else if (r1 / 12 > 9000 && r1 / 12 <= 35000) {
                rate = 0.25;
                reduction = 1005;
                tr[5].setAttribute("class", "active");
            } else if (r1 / 12 > 35000 && r1 / 12 <= 55000) {
                rate = 0.30;
                reduction = 2755;
                tr[6].setAttribute("class", "active");
            } else if (r1 / 12 > 55000 && r1 / 12 <= 80000) {
                rate = 0.35;
                reduction = 5505;
                tr[7].setAttribute("class", "active");
            } else if (r1 / 12 > 80000) {
                rate = 0.45;
                reduction = 13505;
                tr[8].setAttribute("class", "active");
            }
            var r2 = r1 * rate - reduction * 12 - temp2;

            if (r2 >= 0) {
                var h = document.getElementById("title").offsetHeight + document.getElementById("formDiv").offsetHeight;
                document.documentElement.scrollTop = h;
                document.body.scrollTop = h;
                income[batch - 1] = Math.round(count * (shares - price) * exchangeRate * 100) / 100;
                tax[batch - 1] = Math.round(r2 * 100) / 100;

                tempNum = Math.round(count * (shares - price) * exchangeRate * 100).toString();
                var len = tempNum.length;
                max = Math.floor(len / 3) - 1;
                res = "";
                str2 = "";
                res = tempNum.substr(len - 2, len);
                tempNum = tempNum.slice(0, len - 2);
                for (var i = 0; i < max; i++) {
                    len = tempNum.length;
                    var s = tempNum.slice(len - 3, len);
                    tempNum = tempNum.substr(0, len - 3);
                    str2 = (',' + s) + str2;
                }
                ;
                var t1 = tempNum + str2 + "." + res;

                if (r2 == 0) {
                    var t2 = "0.00";
                } else {
                    tempNum = (Math.round(r2 * 100)).toString();
                    var len = tempNum.length;
                    max = Math.floor(len / 3) - 1;
                    res = "";
                    str2 = "";
                    res = tempNum.substr(len - 2, len);
                    tempNum = tempNum.slice(0, len - 2);
                    for (var i = 0; i < max; i++) {
                        len = tempNum.length;
                        var s = tempNum.slice(len - 3, len);
                        tempNum = tempNum.substr(0, len - 3);
                        str2 = (',' + s) + str2;
                    }
                    ;
                    var t2 = tempNum + str2 + "." + res;
                }


                var table = '<table class="resultTable ' + tableType[batch - 1] + '" cellpadding="0" cellspacing="0">' +
                    '<tbody>' +
                    '    <tr>' +
                    '        <td class="pink" width="185">归属批次<span class="tableEn">Vesting Batch<span></td>' +
                    '        <td>第' + batch + '批</td>' +
                    '    </tr>' +
                    '    <tr>' +
                    '        <td class="pink">股权类型<span class="tableEn">Award Type<span></td>' +
                    '        <td>' + taxType[type - 1] + '</td>' +
                    '    </tr>' +
                    '    <tr>' +
                    '        <td class="pink">归属/行权数量<span class="tableEn" style="letter-spacing: -.6px;">vest/exercise units<span></td>' +
                    '        <td>' + count + '</td>' +
                    '    </tr>' +
                    '    <tr>' +
                    '        <td class="red multiple">本批归属/行权收益（RMB）<p class="tableEn">Taxable Income<p></td>' +
                    '        <td>' + t1 + '</td>' +
                    '    </tr>' +
                    '    <tr>' +
                    '        <td class="red multiple">应缴个人所得税（RMB）<p class="tableEn">Tax Payable<p></td>' +
                    '        <td>' + t2 + '</td>' +
                    '    </tr>' +
                    '</tbody>' +
                    '<tfoot>' +
                    '    <tr>' +
                    '        <td>适用税率<span class="tableEn">Tax Rate<span>：' + rate * 100 + '%</td>' +
                    '        <td>速算扣除数<span class="tableEn">Quick Deduction<span>：' + reduction + '</td>' +
                    '    </tr>' +
                    '</tfoot>' +
                    '</table>';
                if (batch - 1 < n) {
                    document.getElementById("table" + batch).innerHTML = table;
                    var r0 = r1 * rate - reduction * 12;
                    for (var l = batch; l < n; l++) {
                        r1 += income[l];
                        r0 += tax[l];
                    }

                    tempNum = Math.round(r1 * 100).toString();
                    var len = tempNum.length;
                    max = Math.floor(len / 3) - 1;
                    res = "";
                    str2 = "";
                    res = tempNum.substr(len - 2, len);
                    tempNum = tempNum.slice(0, len - 2);
                    for (var i = 0; i < max; i++) {
                        len = tempNum.length;
                        var s = tempNum.slice(len - 3, len);
                        tempNum = tempNum.substr(0, len - 3);
                        str2 = (',' + s) + str2;
                    }
                    ;
                    var t3 = tempNum + str2 + "." + res;

                    document.getElementById("totalIncome").innerHTML = t3;
                    document.getElementById("totalIncomeE").innerHTML = t3;

                    if (r0 == 0) {
                        t4 = "0.00";
                    } else {
                        tempNum = (Math.round(r0 * 100)).toString();
                        var len = tempNum.length;
                        max = Math.floor(len / 3) - 1;
                        res = "";
                        str2 = "";
                        res = tempNum.substr(len - 2, len);
                        tempNum = tempNum.slice(0, len - 2);
                        for (var i = 0; i < max; i++) {
                            len = tempNum.length;
                            var s = tempNum.slice(len - 3, len);
                            tempNum = tempNum.substr(0, len - 3);
                            str2 = (',' + s) + str2;
                        }
                        ;
                        var t4 = tempNum + str2 + "." + res;
                    }
                    document.getElementById("totalTax").innerHTML = t4;
                    document.getElementById("totalTaxE").innerHTML = t4;
                } else {
                    tempNum = Math.round(r1 * 100).toString();
                    var len = tempNum.length;
                    max = Math.floor(len / 3) - 1;
                    res = "";
                    str2 = "";
                    res = tempNum.substr(len - 2, len);
                    tempNum = tempNum.slice(0, len - 2);
                    for (var i = 0; i < max; i++) {
                        len = tempNum.length;
                        var s = tempNum.slice(len - 3, len);
                        tempNum = tempNum.substr(0, len - 3);
                        str2 = (',' + s) + str2;
                    }
                    ;
                    var t5 = tempNum + str2 + "." + res;
                    document.getElementById("totalIncome").innerHTML = t5;
                    document.getElementById("totalIncomeE").innerHTML = t5;

                    var test = Math.round((r1 * rate - reduction * 12) * 100);
                    if (test == 0) {
                        var t6 = "0.00";
                    } else {
                        tempNum = test.toString();
                        var len = tempNum.length;
                        max = Math.floor(len / 3) - 1;
                        res = "";
                        str2 = "";
                        res = tempNum.substr(len - 2, len);
                        tempNum = tempNum.slice(0, len - 2);
                        for (var i = 0; i < max; i++) {
                            len = tempNum.length;
                            var s = tempNum.slice(len - 3, len);
                            tempNum = tempNum.substr(0, len - 3);
                            str2 = (',' + s) + str2;
                        }
                        ;
                        var t6 = tempNum + str2 + "." + res;
                    }
                    document.getElementById("totalTax").innerHTML = t6;
                    document.getElementById("totalTaxE").innerHTML = t6;

                    var newNode = document.createElement("div");
                    newNode.setAttribute("id", "table" + batch);
                    newNode.setAttribute("class", "table");
                    newNode.innerHTML = table;
                    document.getElementById("tableDiv").appendChild(newNode);
                    document.getElementById("table" + batch).style.float = "left";
                    document.getElementById("table" + batch).style.margin = "40px 20px 0 20px";
                }
            } else {
                document.getElementById("alert").setAttribute("style", "display:block");
                document.getElementById("mask").setAttribute("style", "display:block");
                document.getElementById("msg").innerHTML = "请检查填写的数据是否正确！<p>Please ensure your filled-in records are accurate</p>";
            }
        }
    }

    function resetForm() {
        tax = [];
        income = [];
        var temp1 = document.getElementById("batchUL").getElementsByTagName("li");
        var temp2 = document.getElementById("typesUL").getElementsByTagName("li");
        var temp3 = document.getElementById("rateTable").getElementsByTagName("tr");
        for (var i = 0; i < temp1.length; i++) {
            temp1[i].removeAttribute("class");
        }
        for (var j = 0; j < temp2.length; j++) {
            temp2[j].removeAttribute("class");
        }
        for (var k = 0; k < temp3.length; k++) {
            temp3[k].removeAttribute("class");
        }
        document.getElementById("batchUL").getElementsByTagName("li")[0].setAttribute("class", "checked");
        document.getElementById("typesUL").getElementsByTagName("li")[0].setAttribute("class", "checked");
        document.getElementById("count").value = "";
        document.getElementById("price").value = "";
        document.getElementById("price").setAttribute("disabled", "disabled");
        document.getElementById("shares").value = "";
        document.getElementById("exchangeRate").value = "";
        document.getElementById("batch").value = "1";
        document.getElementById("types").value = "1";
        document.getElementById("tableDiv").innerHTML = "";
        document.getElementById("totalIncome").innerHTML = "0.00";
        document.getElementById("totalTax").innerHTML = "0.00";
        document.getElementById("totalIncomeE").innerHTML = "0.00";
        document.getElementById("totalTaxE").innerHTML = "0.00";
        placeHolder('count');
        placeHolder('price');
        placeHolder('shares');
        placeHolder('exchangeRate');
        if (navigator.userAgent.indexOf("MSIE") > 0) {
            if (navigator.userAgent.indexOf("MSIE 8.0") > 0 || navigator.userAgent.indexOf("MSIE 7.0") > 0) {
                document.getElementById("price").style.background = "#ccc";
                document.getElementById("price").style.color = "#aaa";
            }
        }
    }

    function placeHolder(id) {
        var obj = document.getElementById(id);
        if (navigator.userAgent.indexOf("MSIE") > 0) {
            var ph = obj.getAttribute("placeholder");
            if (obj.value == "") {
                obj.value = ph;
                obj.setAttribute("style", "color:#ddd");
            } else {
                obj.removeAttribute("style");
            }
        }
    }

    function inputFocus(id) {
        var obj = document.getElementById(id);
        if (navigator.userAgent.indexOf("MSIE") > 0) {
            var ph = obj.getAttribute("placeholder");
            if (obj.value == ph) {
                obj.value = "";
                obj.removeAttribute("style");
            }
        }
    }

    //验证整数
    function isInteger(id) {
        var str = document.getElementById(id).value;
        var regu = /^[-]{0,1}[0-9]{1,}$/;
        var re = new RegExp(regu);
        if (re.test(str)) {
            return true;
        } else {
            document.getElementById(id).value = "";
            return false;
        }
    }

    //验证带小数的整数，最多n位
    function isMoney(id) {
        var s = document.getElementById(id).value;
        var regu = "^[0-9]+[\.][0-9]{0,2}$";
        var re = new RegExp(regu);
        if (re.test(s) || isInteger(id)) {
            return true;
        } else {
            document.getElementById(id).value = "";
            return false;
        }
    }

    function isRate(id) {
        var s = document.getElementById(id).value;
        var regu = "^[0-9]+[\.][0-9]{0,4}$";
        var re = new RegExp(regu);
        if (re.test(s) || isInteger(id)) {
            return true;
        } else {
            document.getElementById(id).value = "";
            return false;
        }
    }

    function closeAlert() {
        document.getElementById("alert").setAttribute("style", "display:none");
        document.getElementById("alert2").setAttribute("style", "display:none");
        document.getElementById("mask").setAttribute("style", "display:none");
    }
</script>



</body></html>